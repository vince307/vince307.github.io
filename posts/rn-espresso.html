<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

    <title>Kamil Pe - Blog - GitHub </title>

  <!-- Bootstrap core CSS -->
  <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="../vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

  <!-- Custom styles for this template -->
  <link href="../css/clean-blog.min.css" rel="stylesheet">

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
    <div class="container">
      <a class="navbar-brand" href="../index.html">KP-Blog</a>
    </div>
  </nav>

  <!-- Page Header -->
  <header class="masthead" style="background-image: url('../img/post-bg.jpg')">
    <div class="overlay"></div>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <div class="post-heading">
            <h1>Querying RN view in Espresso</h1>
<!--            <h2 class="subheading">Problems look mighty small from 150 miles up</h2>-->
            <span class="meta">Posted by
              <a href="#">KP</a>
              on October 17, 2019</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Post Content -->
  <article>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">

          <h2 class="section-heading">[Intro]</h2>

          <p>
            Purpose of this text is to show how view generated by RN code can be accessed from Espresso and how you can query those views in order to access required elements.
            Using Espresso would be a lot easier if you could use a dedicated resource-id. At the moment, it looks like this feature will not be available in the near future. An alternative option is to choose a different testing framework, e.g. cross platform. In our case, the factor that limited the choice of frameworks used for testing is the platform selected as device farm. Where tests are executed on real devices.
          </p>

          <h2 class="section-heading">[Querying elements]</h2>

          <p>
            The main feature of React Native is that all views are generated automatically for both platforms using JavaScript code. That’s convenient, but if we decide to write some test scripts using native frameworks, view hierarchy inspected on iOS and Android can surprisingly differ…
            When building tests, use Android Studio’s Layout Inspector to see what a React Native view is actually mapped to in Android’s native environment.
          </p>

          <a href="#">
            <img class="img-fluid" src="../img/rn-espresso/image7.png" alt="">
          </a>

          <p>
            Also you must keep in mind that ID’s generated by RN can be different when running app on emulator and on live device. So if you are planning to use ID for your test, make sure that it’s a static view and won't be affected by any data fetched via ajax from the server.
            During my play with those “id” references, I realized that screen which was presenting user’s posts has been generating different element id’s, everytime a new post was added to the list. So, this method was not suitable for this particular scenario.
          </p>

          <a href="#">
            <img class="img-fluid" src="../img/rn-espresso/image3.png" alt="">
          </a>

          <p>
            Currently there is no way to set resource-id with react-native, so, to make complex actions you need to write some code (like wait for elements), other things seems to work quite well via android studio 'record espresso test' button. There you can generate query to the view for the element you are looking for, and use one of the below methods to perform action on it:
          </p>
          <ul>
            <li>use prop accessibilityLabel as id for elements (eg. "elementId")</li>
            <li>use onView(allOf(withContentDescription("elementId"), isDisplayed()))</li>
          </ul>

          <a href="#">
            <img class="img-fluid" src="../img/rn-espresso/image8.png" alt="">
          </a>

          <a href="#">
            <img class="img-fluid" src="../img/rn-espresso/image4.png" alt="">
          </a>

          <h2 class="section-heading">[Wait/Delay]</h2>

          <p>
            Sometimes your test will fail at the very beginning, even before starting your application. That happened to me many times. In order to avoid that, I added small custom wait function, which is just testing the view, checking if the element is there and visible.
          </p>

          <a href="#">
            <img class="img-fluid" src="../img/rn-espresso/image1.png" alt="">
          </a>

          <h2 class="section-heading">[Closing words]</h2>

          <p>
            Internet applications, mobile apps, regardless of their purpose, require testing. Testing allows you to check whether the initial assumptions of the system have been met, whether the application works without error and whether the application can be run on the production server, client device.
          </p>

          <p>
            Instrumentation tests run on a device or an emulator. In the background, your app will be installed and then a testing app will also be installed which will control your app, launching it and running UI tests as needed.
          </p>

          <p>
            Espresso allows you to automatically simulate user actions in the application and check the expected result on the UI side, which can improve User Experience of the app. The basic API provided is small, simple, intuitive and is based on interaction and assertion of view states. It is designed to operate on specific views and selected elements of the view collection. Espresso works quickly and ensures proper management of the main thread, thanks to which it runs test commands at the right time, which frees the programmer from the obligation to create temporary workarounds. At least in most cases.
          </p>

          <h2 class="section-heading">[Start with Espresso]</h2>

          <p>
            In order to start writing Espresso tests you need to launch your Android Studio and install Espresso plugin.
          </p>

          <a href="#">
            <img class="img-fluid" src="../img/rn-espresso/image2.png" alt="">
          </a>

          <p>
            To create your first test and generate the test class, you can run Espresso recorder, perform a simple action and save the results.
          </p>

          <a href="#">
            <img class="img-fluid" src="../img/rn-espresso/image6.png" alt="">
          </a>

          <p>
            And that action will produce a test class for you.
          </p>

          <a href="#">
            <img class="img-fluid" src="../img/rn-espresso/image5.png" alt="">
          </a>

          <p>
            And that is it, now you can start building tests for your app.
          </p>


        </div>
      </div>
    </div>
  </article>

  <hr>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <ul class="list-inline text-center">
            <li class="list-inline-item">
              <a href="https://github.com/vince307/">
                <span class="fa-stack fa-lg">
                  <i class="fas fa-circle fa-stack-2x"></i>
                  <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          </ul>
          <p class="copyright text-muted">Copyright &copy; KP 2019</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap core JavaScript -->
  <script src="../vendor/jquery/jquery.min.js"></script>
  <script src="../vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Custom scripts for this template -->
  <script src="../js/clean-blog.min.js"></script>

</body>

</html>
